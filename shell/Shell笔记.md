# Shell笔记
---
笔记参考教程为[The missing semester of your CS education](https://missing-semester-cn.github.io/)，仅仅是作为学习记录，未经允许不得转载。
## 主题1: The Shell
### 1. shell基础
shell是一个编程环境，具备变量、条件、循环和函数。在shell执行命令时，实际上时执行一段shell可以解释执行的简短代码。

shell基于空格对命令进行解析，然后执行第一个单词代表的程序，并将后续单词作为程序可访问的参数。例如：
```shell
lzl:~$ echo hello
hello
```
此处 `echo` 程序可将参数打印在终端上进行显示。

对于不是shell所了解的变成关键字，它会咨询*环境变量* `$PATH` ，它会列出当shell接到某条指令时，进行程序搜索的路径。 `$PATH` 中一系列目录由 `:` 进行分割。确定某个程序名代表的是哪个具体的程序，可以使用 `which` 程序。我们也可以绕过 `$PATH`，通过直接指定需要执行的程序的路径来执行该程序。示例如下：
```shell
lzl:~$ which echo
/bin/echo
lzl:~$ /bin/echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
```

### 2. shell中导航
shell总路径时一组被分割的目录，在Linux中使用 `/` 分割，在Windows上是 `\` 。路径 `/` 代表系统的根目录，所有文件夹包含在这个路径下，Windows中每个盘有一个根目录（如 `C:\` ）。

对于Linux系统，如果某个路径以 `/` 开头，则它是一个绝对路径，其他的都是相对路径。相对路径指相对当前工作目录的路径。`pwd` 命令可以获取当前工作目录。`cd` 命令用于切换目录。路径中，`.` 表示当前目录，而 `..` 表示上级目录。

一般来说，当运行一个程序时，如果没有指定路径，则程序会在当前目录下执行。

为了查看目录下包含文件，可以使用 `ls` 命令，此时会打印当前目录下的文件。多数命令接受标记和选项，它们以 `-` 开头，可以改变程序行为。通常，在执行程序时使用 `-h` 或 `--help` 标记可以打印帮助信息，以便了解有哪些可用的标记或选项。对于`ls` 命令，`-l` 参数可以详细列出目录下文件或文件夹信息。
```shell
lzl:~$ ls -l /home
drwxr-xr-x 1 lzl  users  4096 Dec 16  2025 lzl 
```
首先，本行第一个字符 `d` 表示 `lzl` 是一个目录。然后接下来的九个字符，每三个字符构成一组。`rwx` 它们分别代表了文件所有者（`lzl`），用户组（`users`） 以及其他所有人具有的权限。其中 `-` 表示该用户不具备相应的权限。**`w` 为写权限**，上例中表明只有文件所有这可以修改 `lzl` 文件夹，如添加或删除文件夹中的文件。**`x` 为可执行权限**，上例中表明用户是否具备该文件夹及其父文件夹的搜索权限，从而可以进入文件夹。**`r` 为读权限**，上例中表示用户能否列出它的包含内容。

此外还有部分指令，如`mv` 指令用于重命名或移动文件，`cp` 指令用于拷贝文件，`mkdir` 指令用于新建文件夹。对于所需程序参数，输入输出信息，或工作方式，可以使用 `man` 程序获取，它通过接受程序名作为参数，然后将它的文档展现。

### 3. 在程序间创建连接
在 shell 中，程序有两个主要的“流”：它们的输入流和输出流。当程序尝试读取信息时，它们会从输入流中进行读取，当程序打印信息时，它们会将信息输出到输出流中。通常，一个程序输入输出留都是终端，但是这些流也可以重定向。

最简单的重定向是 `< file` 和 `> file`。这两个命令可以将程序输入输出重定向到文件。
```shell
lzl:~$ echo hello > hello.txt
lzl:~$ cat hello.txt
hello
lzl:~$ cat < hello.txt
hello
lzl:~$ cat < hello.txt > hello2.txt
lzl:~$ cat hello2.txt
hello
```
此外还可以使用 `>>` 向文件追加内容。使用管道进行文件重定向。`|` 操作符允许将一个程序的输出和另外一个程序的输入连接起来。

### 4. 根用户
类Unix系统中，根用户十分特殊，其几乎不受任何限制，可以创建、读取、更新和删除系统中的任何文件。通常不会以根用户身份直接登陆系统，因为可能会由于某些错误操作而破坏系统。取而代之的是在需要的时候使用 `sudo` 命令，作用是可以以super user身份执行一些操作。

例如，要更改屏幕亮度，由于 `|`、`>`和 `<` 是通过shell执行的，而不是被各个程序单独执行。 `echo` 等程序并不知道 `|` 的存在，它们只知道从自己的输入输出流中进行读写。所以shell操作应当为：
```shell
$ sudo find -L /sys/class/backlight -maxdepth 2 -name '*brightness*'
/sys/class/backlight/thinkpad_screen/brightness
$ cd /sys/class/backlight/thinkpad_screen
$ echo 3 | sudo tee brightness
```

### 5. shell脚本
大多数shell都有自己的一套脚本语言，包括变量、控制流和自己的语法。shell脚本与其他脚本语言不同之处在于，shell脚本针对shell所从事的相关工作进行了优化。

bash中为变量赋值的语法是 `foo=bar`，访问变量中存储的数值，其语法为 `$foo`。需要注意的是，`foo = bar` 是不能正确工作的，因为解释器会调用程序 `foo` 并将 `=` 和 `bar` 作为参数。总的来说，在shell脚本中使用空格会起到分割参数的作用，有时候可能会造成混淆。

